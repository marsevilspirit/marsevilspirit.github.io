<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>marsevilspirit&#39;s blog</title><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,viewport-fit=cover"><link rel="canonical" href="https://www.marsevilspirit.com/"><link rel="apple-touch-icon" sizes="180x180" href="/img/marsevilspirit.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/marsevilspirit.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/marsevilspirit.png"><link rel="mask-icon" type="image/png" href="/img/marsevilspirit.png"><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/et-book.min.css"><link rel="stylesheet" href="/css/LXGW.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/highlight/style1.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="marsevilspirit's blog" type="application/atom+xml">
</head><body><div class="wrapper"><div class="container"><header><h2><a href="/">marsevilspirit&#39;s blog</a></h2></header></div><div class="content"><div class="post"><h1>fish的配置</h1><main class="post-md"><h3 id="fish的配置"><a href="#fish的配置" class="headerlink" title="fish的配置"></a>fish的配置</h3><p>今天心血来潮，想试试现代shell是什么感觉。</p><h4 id="下载fish"><a href="#下载fish" class="headerlink" title="下载fish"></a>下载fish</h4><p>arch linux 可通过包管理器一键下载：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -S fish</span><br></pre></td></tr></table></figure><h4 id="使用fish"><a href="#使用fish" class="headerlink" title="使用fish"></a>使用fish</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ fish</span><br></pre></td></tr></table></figure><p>刚开始感觉还不错，用rust写的东西就是<strong>高级</strong>😆。</p><h4 id="修改fish的prompt"><a href="#修改fish的prompt" class="headerlink" title="修改fish的prompt"></a>修改fish的prompt</h4><p>因为之前zsh的prompt用惯了，想改个跟之前一样的：</p><img src="/img/fish_propmt.png" alt="my prompt" width="150" height=""><p>想要自定义prompt，需要对fuction目录下的fish_prompt.fish进行修改:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这是一个简单的提示符，格式如下</span></span><br><span class="line"><span class="comment"># mars:/last-dir (branch|status) $</span></span><br><span class="line"><span class="comment"># 若想自定义，这个网页有教程: https://fishshell.com/docs/current/cmds/fish_git_prompt.html</span></span><br><span class="line"><span class="keyword">function</span> fish_prompt</span><br><span class="line">    <span class="built_in">set</span> -l __last_command_exit_status <span class="variable">$status</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span> -l cyan (set_color -o cyan)</span><br><span class="line">    <span class="built_in">set</span> -l yellow (set_color -o yellow)</span><br><span class="line">    <span class="built_in">set</span> -l red (set_color -o red)</span><br><span class="line">    <span class="built_in">set</span> -l blue (set_color -o blue)</span><br><span class="line">    <span class="built_in">set</span> -l normal (set_color normal)</span><br><span class="line">    <span class="built_in">set</span> -l white (set_color -o white --bold)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span> -l name <span class="variable">$white</span>(<span class="built_in">whoami</span>)</span><br><span class="line">    <span class="built_in">set</span> -l cwd <span class="variable">$cyan</span>(<span class="built_in">basename</span> (prompt_pwd))/</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span> -g __fish_git_prompt_showuntrackedfiles <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="built_in">set</span> -g __fish_git_prompt_showcolorhints <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="built_in">set</span> -g __fish_git_prompt_show_informative_status <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="built_in">set</span> -g __fish_git_prompt_color_prefix blue</span><br><span class="line">    <span class="built_in">set</span> -g __fish_git_prompt_color_suffix blue</span><br><span class="line">    <span class="built_in">set</span> -g __fish_git_prompt_color_branch yellow --bold</span><br><span class="line">    <span class="built_in">set</span> -l git_info (fish_git_prompt)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span> -l dollar <span class="string">&quot;<span class="variable">$normal</span>\$&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> -n -s <span class="string">&quot;<span class="variable">$name</span> $cwd<span class="variable">$git_info</span> <span class="variable">$dollar</span> &quot;</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>再对right_prompt进行设置:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> fish_right_prompt -d <span class="string">&quot;Write out the right prompt&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;[&quot;</span>(<span class="built_in">date</span> <span class="string">&quot;+%H:%M:%S&quot;</span>)<span class="string">&quot;]&quot;</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>最后完美复现先前的prompt。</p><h4 id="禁用fish的自动补全"><a href="#禁用fish的自动补全" class="headerlink" title="禁用fish的自动补全"></a>禁用fish的自动补全</h4><p>为什么我想禁用它呢？因为我觉得这个东西真的很烦，之前也没用过。</p><p>我查官方tutorial, 用下面的命令可以关闭:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ set -g fish_autosuggestion_enabled 0</span><br></pre></td></tr></table></figure><p>放在config.fish可以永久禁用。</p><p>我只能说一句：fish NB!</p><h4 id="修改fish为默认shell"><a href="#修改fish为默认shell" class="headerlink" title="修改fish为默认shell"></a>修改fish为默认shell</h4><p>我们首先通过命令查看当前 shell：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ echo $SHELL</span><br></pre></td></tr></table></figure><p>查看操作系统中存在的 shell 有那些：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/shells</span><br><span class="line"># Pathnames of valid login shells.</span><br><span class="line"># See shells(5) for details.</span><br><span class="line"></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/bin/rbash</span><br><span class="line">/usr/bin/sh</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/usr/bin/rbash</span><br><span class="line">/usr/bin/git-shell</span><br><span class="line">/bin/zsh</span><br><span class="line">/usr/bin/zsh</span><br><span class="line">/usr/bin/systemd-home-fallback-shell</span><br><span class="line">/bin/fish</span><br><span class="line">/usr/bin/fish  &lt;--  我们发现Fish已经安装</span><br></pre></td></tr></table></figure><p>切换 shell，在这里通过<code>chsh</code>命令实现：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chsh -s /usr/bin/fish</span><br></pre></td></tr></table></figure><p>之后reboot重启系统就好了。</p><h3 id="fisher插件管理器"><a href="#fisher插件管理器" class="headerlink" title="fisher插件管理器"></a>fisher插件管理器</h3><p>我使用的fisher作为fish的插件管理器。</p><p>这里要避个雷，oh-my-fish已经不被维护了，不要在使用oh-my-fish了。</p><p>下面的操作具体看官方的github比较好：<a target="_blank" rel="noopener" href="https://github.com/jorgebucaran/fisher">https://github.com/jorgebucaran/fisher</a></p><h4 id="fisher的安装"><a href="#fisher的安装" class="headerlink" title="fisher的安装"></a>fisher的安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -sL https://raw.githubusercontent.com/jorgebucaran/fisher/main/functions/fisher.fish | source &amp;&amp; fisher install jorgebucaran/fisher</span><br></pre></td></tr></table></figure></main><p>Sep 2024</p></div></div></div><footer class="footer"><div class="content has-text-centered"><p><a href="/about">About Mars</a> | <a href="https://github.com/marsevilspirit" , target="_blank">Github</a> | <a href="mailto:marsevilspirit@gmail.com">Email</a></p></div></footer></body></html>