<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>marsevilspirit&#39;s blog</title><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,viewport-fit=cover"><link rel="canonical" href="https://www.marsevilspirit.com/"><link rel="apple-touch-icon" sizes="180x180" href="/img/marsevilspirit.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/marsevilspirit.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/marsevilspirit.png"><link rel="mask-icon" type="image/png" href="/img/marsevilspirit.png"><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/et-book.min.css"><link rel="stylesheet" href="/css/LXGW.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/highlight/style1.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="marsevilspirit's blog" type="application/atom+xml">
</head><body><div class="wrapper"><div class="container"><header><h2><a href="/">marsevilspirit&#39;s blog</a></h2></header></div><div class="content"><div class="post"><h1>Linuxä¸­å•ç‰‡æœºçš„ä»£ç çš„ä¹¦å†™å’Œçƒ§å½•</h1><main class="post-md"><p>ä»Šå¤©ç”µè£…å®ä¹ ï¼Œçªç„¶å¯¹åœ¨Linuxä¸‹å†™å•ç‰‡æœºä»£ç å’Œçƒ§å½•äº§ç”Ÿäº†å…´è¶£ï¼Œ<br>ç‰¹æ„ç ”ç©¶ä¸€ç•ªï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><h3 id="å‡†å¤‡å·¥å…·"><a href="#å‡†å¤‡å·¥å…·" class="headerlink" title="å‡†å¤‡å·¥å…·"></a>å‡†å¤‡å·¥å…·</h3><p>1.å®‰è£…<code>sdcc</code>(ç¼–è¯‘å·¥å…·):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -S sdcc </span><br></pre></td></tr></table></figure><p>2.å®‰è£…<code>stcgal</code>(çƒ§å½•å·¥å…·):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yay -S stcgal</span><br></pre></td></tr></table></figure><h3 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><p>è¿™é‡Œæˆ‘æ²¡è¿‡å¤šç ”ç©¶ï¼Œä¸»è¦äº†è§£äº†ä¸€ä¸‹windowsçš„keilçš„ä»£ç è¿ç§»åˆ°Linuxåï¼Œæ€ä¹ˆä¿®æ”¹:</p><p>â€‹</p><table><thead><tr><th></th><th><strong>Keil C51</strong></th><th><strong>SDCC</strong></th><th></th></tr></thead><tbody><tr><td>å¤´æ–‡ä»¶</td><td>reg51.h&#x2F;reg52.h</td><td>8051.h&#x2F;8052.h</td><td></td></tr><tr><td>ç«¯å£</td><td>P2^0</td><td>P2_0</td><td></td></tr><tr><td>ç«¯å£å®šä¹‰</td><td>sbit LED1&#x3D;P2^0ï¼›</td><td>#define LED1 P2_0</td><td>æ›¿æ¢çš„æ—¶å€™æ³¨æ„åˆ é™¤åé¢çš„åˆ†å·<code>ï¼›</code></td></tr><tr><td>ä¸­æ–­å£°æ˜</td><td>void uart() interrupt 4 using 0</td><td>void uart(void) __interrupt (4) __using (0)</td><td></td></tr><tr><td>ç‰¹æ®Šç±»å‹</td><td>sbitï¼Œsfrï¼Œbitï¼Œcode</td><td>__sbitï¼Œ__sfrï¼Œ__bitï¼Œ__code</td><td>Keilä¸­çš„å¾ˆå¤šç‰¹æ®Šç±»å‹å‰é¢åŠ ä¸Š__å°±æ˜¯sdccä¸­å¯¹åº”çš„ç±»å‹ã€‚</td></tr><tr><td>_nop()_</td><td>Keil C51ä¸“æœ‰</td><td>#define _nop_() __asm NOP __endasm</td><td></td></tr><tr><td>intrins.h</td><td>Keil C51ä¸“æœ‰ï¼Œ SDCCéœ€è‡ªå·±åˆ›å»º</td><td>è‡ªè¡Œåˆ›å»º</td><td></td></tr></tbody></table><h3 id="ç¼–è¯‘ä»£ç "><a href="#ç¼–è¯‘ä»£ç " class="headerlink" title="ç¼–è¯‘ä»£ç "></a>ç¼–è¯‘ä»£ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sdcc your_program.c</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ packihx your_program.ihx &gt; your_program.hex</span><br></pre></td></tr></table></figure><h3 id="çƒ§å½•"><a href="#çƒ§å½•" class="headerlink" title="çƒ§å½•"></a>çƒ§å½•</h3><p>æ¥å…¥USB, è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo stcgal your_program.hex</span><br></pre></td></tr></table></figure><p>è¿™æ—¶ä¼šæé†’ä½ ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Waiting for MCU, please cycle power: </span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åªéœ€è¦å…³å¼€ä¸€ä¸‹å¼€å…³å°±ä¼šè‡ªåŠ¨çƒ§å½•äº†ã€‚</p><h3 id="èœ‚é¸£å™¨å®ç°èœœé›ªå†°åŸ"><a href="#èœ‚é¸£å™¨å®ç°èœœé›ªå†°åŸ" class="headerlink" title="èœ‚é¸£å™¨å®ç°èœœé›ªå†°åŸ"></a>èœ‚é¸£å™¨å®ç°èœœé›ªå†°åŸ</h3><p>ä¸‹é¢æ˜¯æˆ‘ç”¨èœ‚é¸£å™¨å®ç°èœœé›ªå†°åŸçš„éŸ³ä¹ğŸ˜†(ä¸å…‰ç«‹æ–¹ç»“åˆåœ¨ä¸€èµ·):</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;8052.h&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D1 P1_0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D2 P1_1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D3 P1_2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D4 P1_3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D5 P1_4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D6 P1_5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D7 P1_6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> D8 P1_7</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> U1 P2_0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> U2 P2_1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> U3 P2_2</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> uchar unsigned char</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> uint  unsigned int</span></span><br><span class="line">uchar Count;</span><br><span class="line"><span class="type">int</span> mode_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Speak P1_3			 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led1 P0_0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led2 P0_1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led3 P0_2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led4 P0_3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led5 P0_4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led6 P0_5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led7 P0_6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> led8 P0_7</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> __code SONG[] = &#123;</span><br><span class="line">    <span class="comment">/*0xFE, 0x20, // 0     */</span></span><br><span class="line">    <span class="comment">/*0x39, 0x20, // 6low*/</span></span><br><span class="line">    <span class="comment">/*0x30, 0x20, // 1*/</span></span><br><span class="line">    <span class="comment">/*0x2b, 0x20, // 2*/</span></span><br><span class="line">    <span class="comment">/*0x26, 0x20, // 3*/</span></span><br><span class="line">    <span class="comment">/*0x23, 0x20, // 4*/</span></span><br><span class="line">    <span class="comment">/*0x20, 0x20, // 5*/</span></span><br><span class="line">    <span class="comment">/*0x1c, 0x20, // 6*/</span></span><br><span class="line">    <span class="comment">/*0x19, 0x20, // 7*/</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3 </span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x1c</span>, <span class="number">0x10</span>, <span class="comment">// 6</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x10</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x20</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x40</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0xFE</span>, <span class="number">0x40</span>, <span class="comment">// 0 //ä½ çˆ±æˆ‘ï¼Œ æˆ‘çˆ±ä½ ï¼Œ èœœé›ªå†°åŸç”œèœœèœœ</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3 </span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x1c</span>, <span class="number">0x10</span>, <span class="comment">// 6</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x10</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x20</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x40</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0xFE</span>, <span class="number">0x40</span>, <span class="comment">// 0 //ä½ çˆ±æˆ‘ï¼Œ æˆ‘çˆ±ä½ ï¼Œ èœœé›ªå†°åŸç”œèœœèœœ</span></span><br><span class="line">                </span><br><span class="line">    <span class="number">0x23</span>, <span class="number">0x40</span>, <span class="comment">// 4</span></span><br><span class="line">    <span class="number">0x23</span>, <span class="number">0x40</span>, <span class="comment">// 4</span></span><br><span class="line">    <span class="number">0x23</span>, <span class="number">0x20</span>, <span class="comment">// 4</span></span><br><span class="line">    <span class="number">0x1c</span>, <span class="number">0x60</span>, <span class="comment">// 6.</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x40</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0xFE</span>, <span class="number">0x40</span>, <span class="comment">// 0 //ä½ çˆ±æˆ‘å‘€ï¼Œæˆ‘çˆ±ä½ ï¼Œ</span></span><br><span class="line"></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3 </span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x1c</span>, <span class="number">0x10</span>, <span class="comment">// 6</span></span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="comment">// 5</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x10</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x10</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x26</span>, <span class="number">0x20</span>, <span class="comment">// 3</span></span><br><span class="line">    <span class="number">0x2b</span>, <span class="number">0x20</span>, <span class="comment">// 2</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0x30</span>, <span class="number">0x20</span>, <span class="comment">// 1</span></span><br><span class="line">    <span class="number">0xFE</span>, <span class="number">0x40</span>, <span class="comment">// 0 //ä½ çˆ±æˆ‘ï¼Œ æˆ‘çˆ±ä½ ï¼Œ èœœé›ªå†°åŸç”œèœœèœœ</span></span><br><span class="line">    </span><br><span class="line">    <span class="number">0xFF</span>,</span><br><span class="line">    <span class="number">0x00</span>    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mode1</span><span class="params">()</span> &#123;</span><br><span class="line">        U1=<span class="number">1</span>; </span><br><span class="line">        D1=<span class="number">1</span>;</span><br><span class="line">        D2=<span class="number">1</span>;</span><br><span class="line">        D3=<span class="number">1</span>;</span><br><span class="line">        D4=<span class="number">1</span>;</span><br><span class="line">        D5=<span class="number">1</span>;</span><br><span class="line">        D6=<span class="number">1</span>;</span><br><span class="line">        D7=<span class="number">1</span>;</span><br><span class="line">        D8=<span class="number">1</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U1=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        U2=<span class="number">1</span>;</span><br><span class="line">        D1=<span class="number">1</span>;</span><br><span class="line">        D2=<span class="number">0</span>;</span><br><span class="line">        D3=<span class="number">0</span>;</span><br><span class="line">        D4=<span class="number">0</span>;</span><br><span class="line">        D5=<span class="number">0</span>;</span><br><span class="line">        D6=<span class="number">0</span>;</span><br><span class="line">        D7=<span class="number">0</span>;</span><br><span class="line">        D8=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U2=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        U3=<span class="number">1</span>;</span><br><span class="line">        D1=<span class="number">0</span>;</span><br><span class="line">        D2=<span class="number">0</span>;</span><br><span class="line">        D3=<span class="number">0</span>;</span><br><span class="line">        D4=<span class="number">0</span>;</span><br><span class="line">        D5=<span class="number">0</span>;</span><br><span class="line">        D6=<span class="number">0</span>;</span><br><span class="line">        D7=<span class="number">0</span>;</span><br><span class="line">        D8=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U3=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mode2</span><span class="params">()</span> &#123;</span><br><span class="line">        U1=<span class="number">1</span>; </span><br><span class="line">        D1=<span class="number">0</span>;</span><br><span class="line">        D2=<span class="number">0</span>;</span><br><span class="line">        D3=<span class="number">0</span>;</span><br><span class="line">        D4=<span class="number">0</span>;</span><br><span class="line">        D5=<span class="number">0</span>;</span><br><span class="line">        D6=<span class="number">0</span>;</span><br><span class="line">        D7=<span class="number">0</span>;</span><br><span class="line">        D8=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U1=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        U2=<span class="number">1</span>;</span><br><span class="line">        D1=<span class="number">0</span>;</span><br><span class="line">        D2=<span class="number">1</span>;</span><br><span class="line">        D3=<span class="number">1</span>;</span><br><span class="line">        D4=<span class="number">1</span>;</span><br><span class="line">        D5=<span class="number">1</span>;</span><br><span class="line">        D6=<span class="number">1</span>;</span><br><span class="line">        D7=<span class="number">1</span>;</span><br><span class="line">        D8=<span class="number">1</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U2=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        U3=<span class="number">1</span>;</span><br><span class="line">        D1=<span class="number">1</span>;</span><br><span class="line">        D2=<span class="number">1</span>;</span><br><span class="line">        D3=<span class="number">0</span>;</span><br><span class="line">        D4=<span class="number">0</span>;</span><br><span class="line">        D5=<span class="number">0</span>;</span><br><span class="line">        D6=<span class="number">0</span>;</span><br><span class="line">        D7=<span class="number">0</span>;</span><br><span class="line">        D8=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U3=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mode3</span><span class="params">()</span> &#123;</span><br><span class="line">        U1=<span class="number">1</span>; </span><br><span class="line">        D1=<span class="number">1</span>;</span><br><span class="line">        D2=<span class="number">1</span>;</span><br><span class="line">        D3=<span class="number">1</span>;</span><br><span class="line">        D4=<span class="number">1</span>;</span><br><span class="line">        D5=<span class="number">1</span>;</span><br><span class="line">        D6=<span class="number">1</span>;</span><br><span class="line">        D7=<span class="number">1</span>;</span><br><span class="line">        D8=<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// delay02s();</span></span><br><span class="line">        U1=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        U2=<span class="number">1</span>;</span><br><span class="line">        D1=<span class="number">1</span>;</span><br><span class="line">        D2=<span class="number">1</span>;</span><br><span class="line">        D3=<span class="number">1</span>;</span><br><span class="line">        D4=<span class="number">1</span>;</span><br><span class="line">        D5=<span class="number">1</span>;</span><br><span class="line">        D6=<span class="number">1</span>;</span><br><span class="line">        D7=<span class="number">1</span>;</span><br><span class="line">        D8=<span class="number">1</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U2=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">        U3=<span class="number">1</span>;</span><br><span class="line">        D1=<span class="number">1</span>;</span><br><span class="line">        D2=<span class="number">1</span>;</span><br><span class="line">        D3=<span class="number">0</span>;</span><br><span class="line">        D4=<span class="number">0</span>;</span><br><span class="line">        D5=<span class="number">0</span>;</span><br><span class="line">        D6=<span class="number">0</span>;</span><br><span class="line">        D7=<span class="number">0</span>;</span><br><span class="line">        D8=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//delay02s();</span></span><br><span class="line">        U3=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Time0_Init</span><span class="params">()</span> &#123;</span><br><span class="line">    TMOD = <span class="number">0x01</span>; <span class="comment">// å®šæ—¶å™¨0æ¨¡å¼1</span></span><br><span class="line">    IE   = <span class="number">0x82</span>; <span class="comment">// ä½¿èƒ½å®šæ—¶å™¨0ä¸­æ–­</span></span><br><span class="line">    TH0  = <span class="number">0xDC</span>; <span class="comment">// è®¾ç½®å®šæ—¶å™¨åˆå€¼</span></span><br><span class="line">    TL0  = <span class="number">0x00</span>;		</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Time0_Int</span><span class="params">()</span> __<span class="title function_">interrupt</span> <span class="params">(<span class="number">1</span>)</span> &#123;</span><br><span class="line">    TH0 = <span class="number">0xDC</span>; <span class="comment">// å®šæ—¶å™¨é‡è½½</span></span><br><span class="line">    TL0 = <span class="number">0x00</span>;</span><br><span class="line">    Count++;			</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay_xMs</span><span class="params">(uint x)</span> &#123;</span><br><span class="line">    uint i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; x; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Control_LEDs</span><span class="params">(uchar note)</span> &#123;</span><br><span class="line">    <span class="comment">// å…ˆå…³é—­æ‰€æœ‰LED</span></span><br><span class="line">    led1 = led2 = led3 = led4 = led5 = led6 = led7 = led8 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(note) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x30</span>: led1 = <span class="number">0</span>; <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x2b</span>: led2 = <span class="number">0</span>; <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x26</span>: led3 = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x23</span>: led4 = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x20</span>: led5 = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x1c</span>: led6 = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x19</span>: led7 = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xFE</span>: led8 = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">chose_mode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (mode_count % <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: mode1(); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: mode2(); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: mode3(); <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mode_count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ’­æ”¾æ­Œæ›²</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Play_Song</span><span class="params">()</span> &#123;</span><br><span class="line">    uchar Temp1, Temp2;</span><br><span class="line">    uint Addr = <span class="number">0</span>; </span><br><span class="line">    Count = <span class="number">0</span>;			</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        Temp1 = SONG[Addr++]; <span class="comment">// è·å–éŸ³ç¬¦</span></span><br><span class="line">        <span class="keyword">if</span> (Temp1 == <span class="number">0xFF</span>) &#123;</span><br><span class="line">            TR0 = <span class="number">0</span>; <span class="comment">// åœæ­¢å®šæ—¶å™¨</span></span><br><span class="line">            Delay_xMs(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// æ’­æ”¾ç»“æŸ</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (Temp1 == <span class="number">0x00</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>; <span class="comment">// æ’­æ”¾ç»“æŸ</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Temp2 = SONG[Addr++]; <span class="comment">// è·å–æŒç»­æ—¶é—´</span></span><br><span class="line">            TR0 = <span class="number">1</span>; <span class="comment">// å¯åŠ¨å®šæ—¶å™¨</span></span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">                Speak = (Speak == <span class="number">0</span>) ? <span class="number">1</span> : <span class="number">0</span>; <span class="comment">// åˆ‡æ¢å‘å£°çŠ¶æ€</span></span><br><span class="line">                Delay_xMs(Temp1);</span><br><span class="line">                <span class="keyword">if</span>(Temp2 == Count) &#123;</span><br><span class="line">                    Count = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Control_LEDs(Temp1); <span class="comment">// æ§åˆ¶LED</span></span><br><span class="line">            chose_mode(); <span class="comment">// é€‰æ‹©æ¨¡å¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    U1 = <span class="number">0</span>;</span><br><span class="line">    U2 = <span class="number">0</span>;</span><br><span class="line">    U3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    Time0_Init();	</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        Play_Song(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></main><p>Sep 2024</p></div></div></div><footer class="footer"><div class="content has-text-centered"><p><a href="/about">About Mars</a> | <a href="https://github.com/marsevilspirit" , target="_blank">Github</a> | <a href="mailto:marsevilspirit@gmail.com">Email</a></p></div></footer></body></html>